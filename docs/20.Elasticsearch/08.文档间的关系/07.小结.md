---
title: 小结
date: 2022-04-19 20:38:31
permalink: /pages/67fe21/
categories:
  - Elasticsearch
  - 文档间的关系
tags:
  - 
author: 
  name: 樊光瑞
  link: https://github.com/maoHuanZhe
---
很多用例不得不处理关系型数据，在本章中你学习了如何处理这些。
- 对象映射，对于一对一关系最为有用。
- 嵌套文档和父子结构，处理了一对多的关系。
- 反规范化和应用端的连接，对于多对多的关系而言最有帮助
即使是在本地进行，连接操作仍然损害了性能。所以，通常情况下将尽量多的属性放入单个文档是个好主意。对象映射能起到作用是因为它允许文档中存在层级结构。这里搜索和聚集就像在扁平结构的文档上一样运作。需要使用全路径来指向字段，就像 `location.name`。
当你需要避免跨对象的匹配时，嵌套和父子文档可以提供帮助。
- 嵌套文档通常是在索引的时候进行连接，将多个 `Lucene` 文档放入单个分块。对于应用，分块看上去就像一篇单独的 `Elasticsearch ` 文档。
- `parent` 宇段允许你在同一索引中将一篇文档指向其父辈，也就是另一篇文档。`Elasticsearch` 将使用路由来确保父辈和子辈存储在同一分片上，这样查询的时候只需要进行本地连接。
可以使用下面的查询和过滤器来搜索嵌套和父子文档。
- `nested` 查询和过滤器。
- `has_child`查询和过滤器。
- `has_parent` 查询和过滤器。
关系上的聚集只针对嵌套文档，通过 `nested` 和 `reverse_nested` 聚集类型来实现。
对象、嵌套和父子关系，以及通常使用的反规范化技术，能以任何的方式组合，这样就可以同时获得不错的性能和功能。